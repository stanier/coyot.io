var app=angular.module("synapse",[]);app.controller("ClusterManagementCtlr",["$scope","$http",function(e,r){r.get("/cluster/list").success(function(t,s,n,o){function a(t){r.get("//"+e.servers[t].host+":"+e.servers[t].port+"/system/stats?type=simple").success(function(r,s,n,o){e.servers[t].online=r.online,e.servers[t].freemem=r.freemem}).error(function(e,r,t,s){console.log(e)})}e.servers=[];for(var i=0;i<t.length;i++)e.servers[i]={hostname:t[i].hostname,host:t[i].host,port:t[i].port,isWorker:"hybrid"===t[i].type||"worker"===t[i].type,isWeb:"hybrid"===t[i].type||"web"===t[i].type},a(i)}).error(function(e,r,t,s){console.log(e)})}]),app.controller("ServerManagementCtlr",["$scope","$http",function(e,r){e.pageSize=20,e.currentPage=0,e.getStats=function(){r.get("//"+host+":"+port+"/system/stats?type=all").success(function(r,t,s,n){e.server=r,e.server.uptime=new Date(1e3*r.uptime),e.loadAvg()}).error(function(e,r,t,s){console.log(e)})},e.getPlatformClass=function(e){return"linux"==e?"fa fa-linux":"windows"==e?"fa fa-windows":"apple"==e?"fa fa-wheelchair":void 0},e.loadAvg=function(){var r=["-webkit-transform","-ms-transform"];for(var t in e.server.loadavg){var s=Math.floor(e.server.loadavg[t]/e.server.cpu.length*180),n=2*s;for(var o in r)$("#circle-"+t+" .fill, #circle-"+t+" .mask.full").css(r[o],"rotate("+s+"deg)"),$("#circle-"+t+" .fill.fix").css(r[o],"rotate("+n+"deg)")}},e.getPackages=function(){r.get("//"+host+":"+port+"/worker/packages/list").success(function(r,t,s,n){e.packages=r}).error(function(r,t,s,n){e.packages=r})},e.getPackageManagers=function(){r.get("//"+host+":9000/worker/packages/listManagers").success(function(r,t,s,n){e.managers=r}).error(function(r,t,s,n){e.managers=r})},e.postPkgInstl=function(){r.post("//"+host+":"+port+"/worker/packages/install",{manager:e.pkgMngr,query:e.pkgInslQuery}).success(function(r,t,s,n){e.installerResponse=e.installerResponse+r}).error(function(r,t,s,n){e.installerResponse=e.installerResponse+r})}}]),app.filter("bytes",function(){return function(e,r){if(isNaN(parseFloat(e))||!isFinite(e))return"-";"undefined"==typeof r&&(r=1);var t=["bytes","KB","MB","GB","TB","PB"],s=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,Math.floor(s))).toFixed(r)+" "+t[s]}}),app.filter("offsetBy",function(){return function(e,r){return r=+r,e.slice(r)}});